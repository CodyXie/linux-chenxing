# Display Pipeline

## Reverse engineering notes

### Interesting things

- [u-boot boot splash screen display init](https://github.com/linux-chenxing/uboot_msc313e/blob/8fcf8839f002607b789e04f6f51621a85c1826f1/common/cmd_bootlogo.c#L1129)

### i2m offsets

- [0x1F206600 - LPLL](https://github.com/linux-chenxing/uboot_msc313e/blob/8fcf8839f002607b789e04f6f51621a85c1826f1/drivers/mstar/panel/hal/infinity2m/inc/hal_pnl_reg.h#L19)

i2m before bootsplash

```
Wireless-tag# md.w 0x1F206600 0x100
1f206600: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206610: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206620: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206630: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206640: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206650: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206660: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206670: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206680: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206690: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206700: 8801 0000 0420 0000 0000 0000 0000 0000    .... ...........
1f206710: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206720: 5544 0000 0024 0000 0001 0000 0000 0000    DU..$...........
1f206730: 0000 0000 0000 0000 0020 0000 0000 0000    ........ .......
1f206740: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206750: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206760: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206770: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206780: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206790: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
```

after 

```
Wireless-tag# md.w 0x1F206600 0x100                           
1f206600: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206610: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206620: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206630: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206640: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206650: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206660: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206670: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206680: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206690: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2066f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206700: 2201 0000 0420 0000 0042 0000 0001 0000    .".. ...B.......
1f206710: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206720: c3c3 0000 0043 0000 0001 0000 0000 0000    ....C...........
1f206730: 0000 0000 0000 0000 8019 0000 00c0 0000    ................
1f206740: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206750: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206760: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206770: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206780: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f206790: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2067f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
```

- [0x1F225000 - DISPLAY_TOP](https://github.com/linux-chenxing/uboot_msc313e/blob/8fcf8839f002607b789e04f6f51621a85c1826f1/drivers/mstar/panel/hal/infinity2m/inc/hal_pnl_reg.h#L22)

i2m before bootsplash

```
Wireless-tag# md.w 0x1F225000 0x100
1f225000: 0100 0000 0000 0000 0000 0000 ffff 0000    ................
1f225010: 0555 0000 0000 0000 0000 0000 0000 0000    U...............
1f225020: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225030: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225040: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225050: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225060: 0000 0000 0000 0000 0100 0000 0199 0000    ................
1f225070: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225080: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225090: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2250a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2250b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2250c0: 0000 0000 0000 0000 0000 0000 0064 0000    ............d...
1f2250d0: 0000 0000 0005 0000 0000 0000 0010 0000    ................
1f2250e0: 0005 0000 004c 0000 0000 0000 0000 0000    ....L...........
1f2250f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225100: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225110: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225120: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225130: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225140: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225150: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225160: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225170: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225180: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225190: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
```
after

```
Wireless-tag# md.w 0x1F225000 0x100                           
1f225000: 0000 0000 0000 0000 0fff 0000 ffff 0000    ................
1f225010: 0666 0000 0000 0000 0000 0000 0001 0000    f...............
1f225020: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225030: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225040: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225050: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225060: d386 0000 ffff 0000 0100 0000 0199 0000    ................
1f225070: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225080: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225090: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2250a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2250b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2250c0: 0000 0000 0003 0000 0000 0000 0064 0000    ............d...
1f2250d0: 0000 0000 0005 0000 0000 0000 0010 0000    ................
1f2250e0: 0005 0000 004c 0000 0000 0000 0000 0000    ....L...........
1f2250f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225100: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225110: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225120: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225130: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225140: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225150: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225160: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225170: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225180: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225190: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2251f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
```


| offset   | 15 | 14 | 13 | 12 | 11 | 10 | 9 | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 | notes       |
|----------|----|----|----|----|----|----|---|---|---|---|---|---|---|---|---|---|-------------|
| 0x0      | x  | x  | x  | x  | x  | x  | x | x |   |   |   |   |   |   |   |   | resets?     |
| 0xC0 (?) |    |    |    |    |    |    |   |   |   |   |   |   |   |   |   | x | fifo reset? |
| 0xC8 (?) |    |    |    |    |    |    |   |   |   |   |   |   |   |   |   | x | DispToDsiMd |

- [0x1F225200 - DISPLAY_TOP_OP2](https://github.com/linux-chenxing/uboot_msc313e/blob/8fcf8839f002607b789e04f6f51621a85c1826f1/drivers/mstar/panel/hal/infinity2m/inc/hal_pnl_reg.h#L23)


i2m before bootsplash

```
Wireless-tag# md.w 0x1F225200 0x100
1f225200: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225210: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225220: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225230: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225240: 0000 0000 08ab 0000 0464 0000 0000 0000    ........d.......
1f225250: 002b 0000 0000 0000 0004 0000 00bf 0000    +...............
1f225260: 083f 0000 0028 0000 0460 0000 0000 0000    ?...(...`.......
1f225270: 00bf 0000 083f 0000 0028 0000 0460 0000    ....?...(...`...
1f225280: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225290: 002b 0000 0000 0000 0000 0000 00bf 0000    +...............
1f2252a0: 083f 0000 0028 0000 0460 0000 0000 0000    ?...(...`.......
1f2252b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2252c0: 0000 0000 0400 0000 0000 0000 0000 0000    ................
1f2252d0: 0000 0000 0400 0000 0000 0000 0000 0000    ................
1f2252e0: 0000 0000 0400 0000 8080 0000 0080 0000    ................
1f2252f0: 0000 0000 0400 0000 0000 0000 0000 0000    ................
1f225300: 0000 0000 0400 0000 0000 0000 0000 0000    ................
1f225310: 0000 0000 0400 0000 8080 0000 0080 0000    ................
1f225320: ffff 0000 ffff 0000 ffff 0000 ffff 0000    ................
1f225330: fef8 0000 a080 0000 0110 0000 0000 0000    ................
1f225340: 0000 0000 ff80 0000 ffff 0000 0000 0000    ................
1f225350: 0000 0000 0000 0000 1080 0000 0000 0000    ................
1f225360: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225370: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225380: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225390: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2253a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2253b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2253c0: 0019 0000 0c99 0000 8d27 0000 9c63 0000    ........'...c...
1f2253d0: 4b4e 0000 3993 0000 2d02 0000 0000 0000    NK...9...-......
1f2253e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2253f0: 0000 0000 0000 0000 0039 0000 0000 0000    ........9.......
```

after

```
1f225200: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225210: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225220: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225230: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225240: 0000 0000 053f 0000 027a 0000 0000 0000    ....?...z.......
1f225250: 0045 0000 0000 0000 0009 0000 00e6 0000    E...............
1f225260: 04e5 0000 0021 0000 0278 0000 4010 0000    ....!...x....@..
1f225270: 00e6 0000 04e5 0000 0021 0000 0278 0000    ........!...x...
1f225280: 4010 0000 0000 0000 0000 0000 0000 0000    .@..............
1f225290: 002b 0000 0000 0000 0000 0000 00bf 0000    +...............
1f2252a0: 083f 0000 0028 0000 0460 0000 0000 0000    ?...(...`.......
1f2252b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2252c0: 0000 0000 0400 0000 0000 0000 0000 0000    ................
1f2252d0: 0000 0000 0400 0000 0000 0000 0000 0000    ................
1f2252e0: 0000 0000 0400 0000 8080 0000 0080 0000    ................
1f2252f0: 010b 0000 077f 0000 04a9 0000 0000 0000    ................
1f225300: 129c 0000 04a9 0000 1178 0000 1070 0000    ........x...p...
1f225310: 04a6 0000 08bb 0000 8080 0000 0080 0000    ................
1f225320: ffff 0000 ffff 0000 ffff 0000 ffff 0000    ................
1f225330: fef8 0000 a080 0000 0110 0000 0000 0000    ................
1f225340: 0000 0000 ff80 0000 ffff 0000 0000 0000    ................
1f225350: 0000 0000 0000 0000 1080 0000 0000 0000    ................
1f225360: 00ff 0000 107f 0000 007f 0000 0000 0000    ................
1f225370: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225380: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f225390: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2253a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2253b0: 0000 0000 0000 0000 00ff 0000 0000 0000    ................
1f2253c0: 0019 0000 0c99 0000 8d27 0000 9c63 0000    ........'...c...
1f2253d0: 4b4e 0000 3993 0000 2d02 0000 0000 0000    NK...9...-......
1f2253e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2253f0: 0000 0000 0000 0000 001b 0000 0000 0000    ................
```

- [0x1F2A5000 - DPHY](https://github.com/linux-chenxing/uboot_msc313e/blob/8fcf8839f002607b789e04f6f51621a85c1826f1/drivers/mstar/panel/hal/infinity2m/inc/hal_pnl_reg.h#L25)

i2m before bootsplash

```
Wireless-tag# md.w 0x1F2A5000 0x100
1f2a5000: 0043 0000 1003 0000 0002 0000 0f10 0000    C...............
1f2a5010: 000f 0000 0000 0000 2008 0000 0000 0000    ......... ......
1f2a5020: 000f 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5030: 000f 0000 0000 0000 1004 0000 0000 0000    ................
1f2a5040: 03ff 0000 0000 0000 0000 0000 0004 0000    ................
1f2a5050: 0000 0000 ffff 0000 2014 0000 0000 0000    ......... ......
1f2a5060: 0111 0000 0421 0000 0000 0000 0000 0000    ....!...........
1f2a5070: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5080: 000f 0000 0000 0000 300c 0000 000f 0000    .........0......
1f2a5090: 0000 0000 4010 0000 0100 0000 0001 0000    .....@..........
1f2a50a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a50b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a50c0: 0000 0000 0000 0000 0000 0000 3444 0000    ............D4..
1f2a50d0: 0000 0000 0011 0000 0000 0000 0000 0000    ................
1f2a50e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a50f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5100: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5110: 0000 0000 0001 0000 0001 0000 0001 0000    ................
1f2a5120: 0001 0000 0001 0000 0000 0000 0000 0000    ................
1f2a5130: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5140: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5150: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5160: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5170: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5180: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5190: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
```

after

```
Wireless-tag# md.w 0x1F2A5000 0x100                           
1f2a5000: 0043 0000 1003 0000 0002 0000 0f10 0000    C...............
1f2a5010: 000f 0000 0000 0000 2008 0000 0000 0000    ......... ......
1f2a5020: 000f 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5030: 000f 0000 0000 0000 1004 0000 0000 0000    ................
1f2a5040: 03ff 0000 0000 0000 0000 0000 0004 0000    ................
1f2a5050: 0000 0000 ffff 0000 2014 0000 0000 0000    ......... ......
1f2a5060: 0111 0000 0421 0000 0000 0000 0000 0000    ....!...........
1f2a5070: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5080: 000f 0000 0000 0000 300c 0000 000f 0000    .........0......
1f2a5090: 0000 0000 4010 0000 0100 0000 0001 0000    .....@..........
1f2a50a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a50b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a50c0: 0000 0000 0000 0000 0000 0000 3444 0000    ............D4..
1f2a50d0: 0000 0000 0011 0000 0000 0000 0000 0000    ................
1f2a50e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a50f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5100: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5110: 0000 0000 0001 0000 0001 0000 0001 0000    ................
1f2a5120: 0001 0000 0001 0000 0000 0000 0000 0000    ................
1f2a5130: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5140: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5150: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5160: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5170: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5180: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a5190: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51a0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51b0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51c0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51d0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51e0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
1f2a51f0: 0000 0000 0000 0000 0000 0000 0000 0000    ................
```
